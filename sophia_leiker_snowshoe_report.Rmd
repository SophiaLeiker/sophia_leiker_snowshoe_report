---
title: "Snowshoe Report"
author: "Sophia Leiker"
date: "11/4/2021"
output: html_document
---

```{r setup, include=FALSE, warning=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(tidyverse)
library(here)
library(lubridate)
library(broom)
library(kableExtra)
library(janitor)
library(ggbeeswarm)
```

## 1. Introduction

SOPHIA RETURN TO THIS AT THE END
you will explore the counts and sizes of juvenile snowshoe hares recorded from 1998 - 2012.

<center>

![Snowshoe Hare](https://cff2.earth.com/uploads/2021/10/08090101/shutterstock_5195162772-960x640.jpg){width=60%}


**Figure 1.** Snowshoe Hare. *Photo Credit:  Andrei Ionescu, Earth.com Staff Writer*

</center>

***

## 2. Data and Analysis 

[Bonanza Creek LTER](https://www.lter.uaf.edu/research) is part of the US Long Term Ecological Research Network that is through the Institute of Arctic Biology at the University of Alaska Fairbanks. The data being used for this analysis is avalible from Kielland, K., F.S. Chapin, R.W. Ruess and their study [Snowshoe hare physical data in Bonanza Creek Experimental Forest: 1999-Present](https://portal.edirepository.org/nis/metadataviewer?packageid=knb-lter-bnz.55.22) where they "conducted capture-recapture studies of snowshoe hares at 5 locales in the Tanana valley, from Tok in the east to Clear in the west from 1999 to 2002." In their study they found that Snowshoe hare densities were highest in 1999 ( =6.36 ha-1, SE=0.63) and declined thereafter. They were unable to detect declines in apparent survival during declining densities in studied study populations. They stated that the movement distances did not vary temporally and persistence of individuals through declining densities may be associated positively with body condition at the peak. 

```{r}
hares <- read_csv(here("data", "bonanza_hares.csv"))
```


***

## 3. Annual Juvenile Hare Trap Counts 

- Annual juvenile hare trap counts were counted during each year of the study
- Grouping and summarizing to assess the counts each year

```{r}
# Converting the date to mdy format and then mutating to pull out the year 
hare_counts <- hares %>% 
  filter(age == "j") %>% 
  mutate(date = mdy(date)) %>% 
  mutate(year = year(date))

#Grouping by year and then adding up the total counts per year 
hare_table <- hare_counts %>% 
  group_by(year) %>% 
  summarise(total = n())
```


```{r}
ggplot(data = hare_table, aes(x = year, y = total)) +
  geom_col(color = "white", fill = "cyan4") +
  labs(x = "Year", y = "Total Juvenile Hare Trappings", title = "Count of Total Juvenile Hare Trappings Per Year", subtitle = "Data from: Kielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER") +
  theme_grey() +
  theme(plot.title = element_text(hjust = 0.5)) +
  scale_x_continuous(breaks = 1999:2012)
```

**Figure 2.** Count of total juvenile hare trappings from 1999 to 2012

```{r hare analysis}
hare_table_stats <- hare_table %>% 
  summarise(hare_mean = round(mean(total),1),
            hare_median = median(total),
            hare_sd = round(sd(total),1),
            hare_max = max(total),
            hare_min = min(total)
            )
```



**Analysis**: The minimum count of juvenile hare trapping (for those years where juvenile hares were actually trapped therefore values over 0), is `r hare_table_stats$hare_min`, the maximum count of juvenile hare trapping is `r hare_table_stats$hare_max`. The mean of juvenile hare trapping is `r hare_table_stats$hare_mean`, the median is `r hare_table_stats$hare_median`. The standard deviation of the count of juvenile hare trapping is `r hare_table_stats$hare_sd`. In general there was a high number of juvenile hares trapped in 1999 and 2000, but there is a trend of decreasing hare traps moving towards 2012, with spikes in 2005 and 2008. Moving forward in order to standardize the analysis of juvenile hare populations I would recommend ensuring that for each year that traps are put out for the study, they are left out the same number of days, checked at the same frequency, and placed in the same locations. By doing this, one can eliminate factors such as the habitat preferences of the hares and make sure that there is consistency across years. 



**Table 1.** Descriptive statistics (mean, median, standard deviation, min, and max) for juvenile hare trap counts
```{r descriptive_stats}
hare_table_stats %>% 
  kbl(col.names = c("Count Mean", "Count Median", "Count Standard Deviation", "Count Max", "Count Min")) %>% 
  kable_styling(bootstrap_options = "striped", full_width = FALSE)

```

***

## 4. Juvenile Hare Weights


```{r comparing weights by sex and site}

hare_weights <- hare_counts %>% 
  group_by(sex, grid) %>% 
  mutate(sex = case_when(
    sex == "f" ~ "Female",
    sex == "m" ~ "Male", 
    is.na(sex) == TRUE ~ "Unknown")) %>% 
  mutate(grid = case_when(
    grid == "bonrip" ~ "Bonanza Riparian",
    grid == "bonmat" ~ "Bonanza Mature",
    grid == "bonbs" ~ "Black Spruce"
  ))
```


```{r}
ggplot(data = hare_weights, aes(x = sex, y = weight)) +
  geom_beeswarm(aes(color = sex)) +
  geom_boxplot(fill = NA, width = 0.4, outlier.color = NA) +
  facet_wrap(~grid) +
  scale_color_manual(values = c("deeppink3","blue","green")) + 
  labs(x = "Hare Sex", y = "Hare Weight (g)", title = "Distribution of Hare Weights by Site and Sex", subtitle = "Data from: Kielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER") +
  guides(fill = guide_legend(title = "Hare Sex")) +
  stat_summary(fun=mean, 
               geom="point", 
               shape=15, 
               size=3, 
               color="black", 
               fill="black") 

```


**Figure 3.** Relationship between hare sex and hare weight (g) for the three sample sites. Points indicate individual hare measurements with red points indicating female hares, blue points indicating male hares and green points indicating an unknown hare sex. The black square indicates the mean for each set of observations. The box plots in black indicate the 25th and 75th percentile values of the data spread, the black line indicates the median value, the black box indicates the mean value for each juvenile hare sex category.


```{r hare weight stats}
hare_females_riparian <- hare_weights %>% 
  filter(sex == "Female", grid == "Bonanza Riparian") %>% 
  pull(weight) %>% 
  na.omit()
female_riparian <- round(mean(hare_females_riparian),1)

hare_males_riparian <- hare_weights %>% 
  filter(sex == "Male", grid == "Bonanza Riparian") %>% 
  pull(weight) %>% 
  na.omit()
male_riparian <- round(mean(hare_males_riparian), 1)

hare_males_spruce <- hare_weights %>% 
  filter(sex == "Male", grid == "Black Spruce") %>% 
  pull(weight) %>% 
  na.omit()
male_spruce <- round(mean(hare_males_spruce), 1)

```


**Analysis** Bonanza Riparian has most observations as illustrated by more points in the beeswarm plot. On average, the male juvenile hares had higher weights than the female juvenile hares across the three study sites. This can be seen in the Bonanza Riparian zone where the average weight of females is `r female_riparian` (g), and the average weight of males is `r male_riparian` (g). In general, there were fewer samples collected for the "unknown" juvenile hare sex category so statistics related to these samples may not be the most reflective of the actual population spread. The spread of Male observations was much higher in the Bonanza Mature cite and Bonanza Riparian in relation to the Black Spruce cite, this can be seen by the box plots having a larger interquartile range in these two cites for the male observations. On average, the observations for both male and female weights are higher in the black spruce sample site compared to the Bonanza Mature cite and Bonanza Riparian cites, with the highest average seen for the males in the Black Spruce cite with a value of `r male_spruce` (g).

***

## 5. Juvenile Weight Comparison (Male vs Female)

```{r}
hare_females <- hare_weights %>% 
  filter(sex == "Female")

print(hare_females)

hare_males <- hare_weights %>% 
  filter(sex == "Male")
```

```{r include=FALSE}
#CREATING Exploratory graphs (e.g. histograms, QQ-plots) to explore assumptions of the t-test

#Lets create some histograms
ggplot(data = hare_weights, aes(x= weight, fill = sex)) + 
  geom_histogram() +
  labs(x = "Hare Weight (g)", y = "Count of Hare Weights", title = "Distribution of Hare Weights by Sex", subtitle = "Data from: Kielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER")

ggplot(data = hare_females, aes(x= weight)) + 
  geom_histogram() +
  labs(x = "Hare Weight (g)", y = "Count of Hare Weights", title = "Distribution of Female Hare Weights", subtitle = "Data from: Kielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER")


# Lets make some QQ plots
ggplot(data = hare_females, aes(sample = weight)) +
  geom_qq() +
  labs(title = "QQ for Females")

ggplot(data = hare_males, aes(x= weight)) + 
  geom_histogram() +
  labs(x = "Hare Weight (g)", y = "Count of Hare Weights", title = "Distribution of Male Hare Weights", subtitle = "Data from: Kielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER")

ggplot(data = hare_males, aes(sample = weight)) +
  geom_qq() +
  labs(title = "QQ for Males")
```

```{r}
hare_female_stats <- hare_females %>% 
  summarise(female_mean = round(mean(weight),1)
            #female_median = median(weight),
           # female_sd = round(sd(weight),1),
            #female_max = max(weight),
            #female_min = min(weight)
            )

print(hare_female_stats)

hare_female_stats %>% 
  kbl(col.names = c("Female Weight Mean", "Female Weight Median", "Female Weeight Standard Deviation", "Female Weight Max", "Female Weight Min")) %>% 
  kable_styling(bootstrap_options = "striped", full_width = FALSE)
```


***

## 6. Relationship Between Juvenile Weight & Hindfoot Length

***

## 7. Summary

***











## 8. Citations
**Data citation**: Kielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER. 2017. Snowshoe hare physical data in Bonanza Creek Experimental Forest: 1999-Present ver 22. Environmental Data Initiative.https://doi.org/10.6073/pasta/03dce4856d79b91557d8e6ce2cbcdc14

